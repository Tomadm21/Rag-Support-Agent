# Workflow Overview

## Core Support Workflow

The system follows a "classify, retrieve, generate" pattern, orchestrated by LangGraph.

```mermaid
sequenceDiagram
  participant User
  participant API
  participant Classifier
  participant Retriever
  participant Generator
  participant Weaviate

  User->>API: Send Query
  API->>Classifier: Analyze (Category/Urgency)
  Classifier-->>API: Metadata
  
  API->>Retriever: Fetch Context
  Retriever->>Weaviate: Vector Search (filtered by Category)
  Weaviate-->>Retriever: Relevant Chunks
  Retriever-->>API: Context
  
  API->>Generator: Draft Response
  Generator-->>API: Response Text
  
  API-->>User: Stream Response (SSE)
```

## Data Flow

```mermaid
flowchart LR
  Input[User Query] --> Classify[Classifier Agent]
  Classify -->|Category| Retrieve[Retriever Agent]
  Retrieve -->|Context| Generate[Generator Agent]
  Generate -->|Draft| State[State Manager]
  State --> Output[Final Response]
```

## State Management

The `TicketState` dict manages the request lifecycle:

- `ticket_id`: Unique identifier
- `customer_query`: Original input
- `category`: Technical/Billing/Feature/Bug
- `confidence_score`: Float 0-1
- `draft_response`: The LLM generation
